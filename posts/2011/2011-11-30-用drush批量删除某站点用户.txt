# 用drush批量删除某站点用户


站点 abcd 有1万多用户，现在我只想保留用户名中有 abcd的用户，其它删除。

不想从数据库中直接删除因为怕有残留数据。决定用drush。

我用的方法：

1、用phpmyadmin导出用户名，
    
        SELECT name FROM `users`
        
2、将上面的结果导出为csv:  users.to.del !! 注意：让英文双引号扩住用户名这在后面很有用

3、去掉csv中用户名含abcd的用户

    grep -v abcd users.to.del > users.new

4、别忘了再去掉管理员帐号，手工编辑 users.new

5、在剩下的每行前面加上 drush ucan 

    drush @sitename ucan "someusername"

6、sh uers.new 就可以了。这时候双引号就有作用了。因为在shell中运行，如果你是中文用户名或者用户名有空格，如果不用英文双引号扩住，drush会不正常推出的。英文单引号都不行。






2011-11-30