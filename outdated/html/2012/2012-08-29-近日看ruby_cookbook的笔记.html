<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>近日看ruby cookbook的笔记</title>
    <link href="/css/local.css" rel="stylesheet">
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3301463-1']);
    _gaq.push(['_trackPageview']);
   (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    </head>
    <body>
      <h1>近日看ruby cookbook的笔记</h1>

<h2>用Time.at(number)来转换unix时间戳到普通人能理解的时间格式</h2>

<blockquote>
  <blockquote>
    <p>Time.at(0)
=&gt; 1970-01-01 07:00:00 +0700
Time.at(10)</p>
  </blockquote>
</blockquote>

<blockquote>
  <blockquote>
    <p>Time.at(1330000000)
=&gt; 2012-02-23 20:26:40 +0800
这是一个时间对象不是字符串，因此可以查其属性
t= Time.at(1330000000)
=&gt; 2012-02-23 20:26:40 +0800
t.sec
=&gt; 40
t.hour
=&gt; 20
t.min
=&gt; 26
t.day
=&gt; 23
t.mon
=&gt; 2
t.year
=&gt; 2012
t.zone
=&gt; “CST”
t.year
=&gt; 2012
t.wday # weekday，周日是0；4就是周五
=&gt; 4
t.yday # 该年的第多少天
=&gt; 54</p>
  </blockquote>
</blockquote>

<blockquote>
  <blockquote>
    <p>Time.now
显示当前时间。</p>
  </blockquote>
</blockquote>

<blockquote>
  <blockquote>
    <p>Time.local(2012,1,24,22,33,44)
=&gt; 2012-01-24 22:33:44 +0800
构建一个当前时区的时间</p>
  </blockquote>
</blockquote>

<blockquote>
  <blockquote>
    <p>Time.local(2555,1,24,22,33,44)
=&gt; 2555-01-24 22:33:44 +0800
佛教年的2012年</p>
  </blockquote>
</blockquote>

<h2>写一个重排文本每行字数的ruby程序</h2>

<p>#不起作用啊
def reformat_wrapped(s, width = 78)
        lines = []
        line = “”
        s.split(/s+/).each do |word|
                if line.size + word.size &gt; width
                        lines « line
                        line = word
                elsif line.empty?
                        line = word
                else
                        line « ” ” « word
                end
        end</p>

<pre><code>    lines &lt;&lt; line if line # 这行是干嘛的？
    return lines.join("\n") end
</code></pre>

<h2>string[/regex/]可找到字符串中第一个出现的正则</h2>
<p>s = “My kingdom for a string!”
=&gt; “My kingdom for a string!”
irb(main):072:0&gt; s[/dom/]
=&gt; “dom”
irb(main):073:0&gt; s[/…/]
=&gt; “My “
irb(main):074:0&gt; s[/ … /]
=&gt; “ for “</p>

<p>我之前不知道[]也接受正则。</p>

<p>普通用法
irb(main):075:0&gt; a
=&gt; “狗狗够猫猫冒”
irb(main):076:0&gt; a[2,1]
=&gt; “够”
irb(main):077:0&gt; a[2,2]
=&gt; “够猫”
irb(main):078:0&gt; a.slice(2,1)
=&gt; “够”
irb(main):079:0&gt; a.slice(2,2)
=&gt; “够猫”</p>

<p>两个整数参数的意思是：第一个为开始字符的index，第二个是从该index走的长度。</p>

<p>irb(main):090:0&gt; a[2…s.length]  # 从index 2到结尾
=&gt; “够猫猫冒”</p>

<h2>ruby下把windows的回车转换成的： text.gsub(“\n\r”, “\n”)</h2>

<pre><code>    text.gsub("\n\r", "\n")
    text.gsub(/\n\r/, "\n") 两个都可以。
</code></pre>

<p>将所有空白都统一成一个空格
        text.gsub(/\s+/, “ “)</p>

<h2>ruby的 String#capitalzie方法把字符串第一个字母大写后，其它所有字母都转为小写</h2>

<p>irb(main):035:0&gt; s = “i am in the US.”
=&gt; “i am in the US.”
irb(main):036:0&gt; s.capitalize
=&gt; “I am in the us.”</p>

<p>后面本应该大写的专有名词也会小写。这点容易忽略。</p>

<p>编写只大写第一个字符的方法：</p>

<p>irb(main):038:0&gt; class String
irb(main):039:1&gt; def capitalize_first_letter
irb(main):040:2&gt; self[0].chr.capitalize + self[1,size]
irb(main):041:2&gt; end
irb(main):042:1&gt; end
=&gt; nil
irb(main):043:0&gt; s
=&gt; “i am in the US.”
irb(main):044:0&gt; s.capitalize_first_letter
=&gt; “I am in the US.”
摘自 ruby cookbook 1st ed</p>

<h2>ruby的String#tr方法</h2>
<p>tr就是translate，和bash中的用法相似</p>

<p>irb(main):047:0&gt; ‘LOWERCASE ALL VOWELS’.tr(‘AEIOU’, ‘aeiou’)
=&gt; “LoWeRCaSe aLL VoWeLS”</p>

<h2>ruby中写一个英文词频统计和中文字频统计的程序</h2>

<h3>英文词频统计</h3>
<p>irb(main):001:0&gt; def word_count(string)
irb(main):002:1&gt; frequencies = Hash.new(0)
irb(main):003:1&gt; string.downcase.scan(/\w+/) {|word| frequencies[word] += 1}
irb(main):004:1&gt; return frequencies
irb(main):005:1&gt; end
=&gt; nil
irb(main):008:0&gt; s = “dogs dog dogs dog dog”
=&gt; “dogs dog dogs dog dog”
irb(main):009:0&gt; word_count(s)
=&gt; {“dogs”=&gt;2, “dog”=&gt;3}
irb(main):010:0&gt; s = “dogs dog dogs dog dog”^C</p>

<h3>中文字频统计</h3>
<p>irb(main):010:0&gt; a =”狗狗够猫猫冒”
=&gt; “狗狗够猫猫冒”</p>

<p>irb(main):011:0&gt; word_count(a)
=&gt; {} # 直接用英文的那个不管作用，因为 \w把中文不起作用；即使是utf8</p>

<blockquote>
  <p>b = ‘shuru f$ 可是 fayu’ # 另一个例子 \w 会忽略中文
=&gt; “shuru f$ 可是 fayu”
irb(main):027:0&gt; word_count(b)
=&gt; {“shuru”=&gt;1, “f”=&gt;1, “fayu”=&gt;1}</p>
</blockquote>

<h1>我根据scan可以正确识别中文字符改进之前函数</h1>
<p>irb(main):012:0&gt; def occur(s) # 编写适合中文的
irb(main):013:1&gt; f = Hash.new(0)
irb(main):014:1&gt; s.scan(/./){|c| f[c] += 1}
irb(main):015:1&gt; return f
irb(main):016:1&gt; end
=&gt; nil
irb(main):017:0&gt; occur(a)
=&gt; {“狗”=&gt;2, “够”=&gt;1, “猫”=&gt;2, “冒”=&gt;1}</p>


    </body>
    <footer>
    <a href="../">Up    </a>
    <a href="/">Home</a>
    <!-- generated on 2013-01-23 09:55:55 +0800 -->
    </footer>
</html>

