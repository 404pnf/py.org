<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>再次遇到 SSH Server And “Permission denied (publickey)</title>
    <link href="/css/local.css" rel="stylesheet">
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3301463-1']);
    _gaq.push(['_trackPageview']);
   (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    </head>
    <body>
      <h1>再次遇到 SSH Server And “Permission denied (publickey)</h1>

<p>用这个关键词搜索才找到howtogeek上答案： sshd : Authentication refused: bad ownership or modes for directory /</p>

<p>直接用我文章题目中的搜索，这次不管用。</p>

<h2>看log</h2>
<pre><code>    $ grep sshd /var/log/audit/audit.log  
</code></pre>

<p>这个命令很有用。它会告诉你原因。</p>

<p>May 17 16:21:25 localhost sshd[30255]: Authentication refused: bad ownership or modes for directory /home/username</p>

<p>原因很清楚了。是目录权限不对。</p>

<h2>方法是：</h2>

<p>Fixing Authentication refused: bad ownership or modes for directory
From HowToGeek
If you get this error in your logs when trying to setup public key authenticated automatic logins, the problem is a permissions one.
You’ll need to perform the following commands on the user account you are trying to setup:</p>

<pre><code>    chmod go-w ~/
    chmod 700 ~/.ssh
    chmod 600 ~/.ssh/authorized_keys
</code></pre>

<p>http://www.howtogeek.com/wiki/Fixing_Authentication_refused:_bad_ownership_or_modes_for_directory</p>

<pre><code>    chmod go-w ~/  这个很重要。如果你的用户目录被设定为其它用户和组用户可以写，那么即时你更改了 .ssh 目录和其文件也不管用！！！！！ 我浪费了多少时间啊。 ：（ 我做了下面两步，但还是不行。 Permission denied (publickey).
</code></pre>

<p>Make sure you do the following:</p>

<p>Make sure the permissions of the .ssh folder are 0700
Make sure the permissions of the authorized_keys file are 0600
Make sure the user owns the .ssh folder and contents (normally that’s the case but just to make sure)
http://blog.artooro.com/2010/02/19/ssh-server-and-permission-denied-publickey/</p>

<p>$ grep sshd /var/log/audit/audit.log </p>

<p>May 17 16:21:25 localhost sshd[30255]: Authentication refused: bad ownership or modes for directory /home/fltrp
May 17 16:21:35 localhost sshd[30257]: Authentication refused: bad ownership or modes for directory /home/fltrp
http://serverfault.com/questions/230771/ssh-configuration-publickeys-permission-denied-publickey-password-error</p>


    </body>
    <footer>
    <a href="../">Up    </a>
    <a href="/">Home</a>
    <!-- generated on 2013-01-23 09:55:58 +0800 -->
    </footer>
</html>

