<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Smarty应用心得</title>
    <link href="/css/local.css" rel="stylesheet">
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3301463-1']);
    _gaq.push(['_trackPageview']);
   (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    </head>
    <body>
      <h1>Smarty应用心得</h1>

<p>xiaola请不要虚该这篇文章的格式<br />
留着 
因为我已经报告了bug
http://drupal.org/node/92111
维护人员回国来看的</p>

<p>bxy</p>

<p>–</p>

<p>Smarty是PHP官方提供的模版引擎，最近研究了一下Smarty的应用，发现确实非常好用，而且通过Smarty也扩展了自己的以模版为引擎的设计思</p>

<p>路。
这里只谈谈自己的感受和应用心得：
模版技术的基础就是变量替换，包括纯静态变量的替换和动态变量替换。因此，Smarty中提供了从CONFIG文件中读取的静态方式（类似java的s</p>

<p>truts的资源文件）和从Smarty运行文件中“动态”方式。</p>

<p>Smarty中为了配合这种变量替换方式，提供了流程控制语句（它自己叫做函数，事实上它也确实是成员函数，因为Smarty是一个类）、方法和</p>

<p>属性以满足用户更多的个性化要求。</p>

<p>我个人的应用情况是，我希望做一个自动翻页类，通过传递数据对象而自动生成带翻页功能的数据显示。在没有应用Smarty之前，需要自己开</p>

<p>发模版引擎以实现显示方式的多样化或显示方式的可定制化。</p>

<p>现在让我们看看效果
[img_assist|nid=552|title=smarty|desc=|link=node|align=left|width=200|height=150]</p>

<p>而实现的模版的代码只有几行：</p>

<pre><code>{include file='showdata.css.tpl'}{section name=sec_titles loop=$titles}
</code></pre>

<p>{$titles[sec_titles]}</p>

<pre><code>{/section}

{section  name=sec_rs loop=$rs start=$start_pos max=$pagesize}
</code></pre>

<p>{section  name=value loop=$rs[sec_rs]}</p>

<p>{$rs[sec_rs][value]}</p>

<pre><code>{/section}

{/section}{$pageDetails}
</code></pre>

<p>{$pageinfo}</p>

<p>其中’showdata.css.tpl’是自定义的CSS模版。</p>

<p>让我们再来看看Smarty中调用该模版的代码：</p>

<pre><code>&lt;?php 
require_once("inc/database.inc.php");
require_once("class/turnpage.class.php");

$sql="select CustomerID,CompanyName,ContactName,ContactTitle,Address,city from customers order by customerid";
$RecordSet=$db-&gt;execute($sql);

$turnPage=new TurnPage($RecordSet,$_REQUEST["page"],$_SERVER['PHP_SELF');



$turnPage-&gt;selectTemplate("showdata.tpl");

?&gt;
</code></pre>

<p>看到了吗，就这么短短几行既可实现图片中的效果。当然，你需要自己花些心思在翻页类上。
注：turnpage.class.php为自定义翻页类，database.inc.php为自定义数据库连接文件</p>

<p>最后看看翻页类中处理的语句吧：</p>

<pre><code>$titles=array("客户号","公司名称","联系人","职位","地址","城市");
$this-&gt;smarty-&gt;assign(titles,$titles);
$this-&gt;smarty-&gt;assign(pageinfo , $this-&gt;pageinfo);
$this-&gt;smarty-&gt;assign(rs,$this-&gt;rs-&gt;getArray());
$this-&gt;smarty-&gt;assign(start_pos,$this-&gt;getStartPosition());
$this-&gt;smarty-&gt;assign(pagesize,$this-&gt;getPageSize());
 
$this-&gt;smarty-&gt;assign(border_color,$this-&gt;border_color);
$this-&gt;smarty-&gt;assign(bg_color,$this-&gt;bg_color);
$this-&gt;smarty-&gt;assign(bg_color2,$this-&gt;bg_color2);
$this-&gt;smarty-&gt;assign(tb_font_size,$this-&gt;tb_font_size);
$this-&gt;smarty-&gt;assign(tb_font_color,$this-&gt;tb_font_color);
$this-&gt;smarty-&gt;assign(tb_title_size,$this-&gt;tb_title_size);
$this-&gt;smarty-&gt;assign(tb_title_color,$this-&gt;tb_title_color);
$this-&gt;smarty-&gt;assign(title_bg_color,$this-&gt;title_bg_color);
$this-&gt;smarty-&gt;assign(tb_title_weight,$this-&gt;tb_title_weight);
 
$this-&gt;smarty-&gt;display($template_name);
</code></pre>

<p>是的，全部都是变量替换的命令！简单吧:)</p>

    </body>
    <footer>
    <a href="../">Up    </a>
    <a href="/">Home</a>
    <!-- generated on 2013-01-23 09:55:38 +0800 -->
    </footer>
</html>

