<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>sed使用中的一个错误让我加深了对 -n 和 p 两个开关的理解</title>
    <link href="/css/local.css" rel="stylesheet">
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3301463-1']);
    _gaq.push(['_trackPageview']);
   (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    </head>
    <body>
      <h1>sed使用中的一个错误让我加深了对 -n 和 p 两个开关的理解</h1>

<p>sed使用中的一个错误让我加深了对 -n 和 p 两个开关的理解</p>

<h2>需要解决的问题</h2>

<p>有一个文件，有1很多标题，看例子</p>

<hr />

<p>1 您的个人信息</p>

<p>很多文字。。。</p>

<p>2 阅读《不告诉你什么杂志》的目的</p>

<p>很多文字。。。</p>

<p>3 阅读习惯和爱好</p>

<p>很多文字。。。</p>

<p>4 关于您对加注释文章的看法</p>

<p>很多文字。。。
…</p>

<hr />

<p>现在我要让每个标题有html的段落标识。就是标题的最前面和最后面分别加和</p>

<p>下面是我的脚本，这是正确的。虽然我还是建议您不要直接用-i，而是重定向 &gt; test4.html</p>

<pre><code>    sed 's/^\([0-9].*$\)/ \1/g' test3.html -i
  

    sed  's/^\([0-9].*$\)/\1/g' test3.html -i
</code></pre>

<h2>我开始的时候错误地应用了 -n 和 p !!!</h2>

<p>我在检测我脚本做了什么修改的时候总用 -n p</p>

<p>比如上面的脚本先看看它做了什么修改对文章</p>

<pre><code>      sed -n 's/^\([0-9].*$\)/\1/gp' test3.html 
</code></pre>

<p>-n 的意思是不打印修改后结果，修改什么都不输出。p是打印的意思。我两个放在一起用就之输出发生改变的行。很方便看到哪些行改变了，改变的结果是什么。非常方便。</p>

<p>这时的输出应该只有那些修改的行。那些“很多文字”都不会被输出。只输出更改的行。</p>

<p>–1 您的个人信息2 阅读《不告诉你什么杂志》的目的3 阅读习惯和爱好4 关于您对加注释文章的看法</p>

<p>…</p>

<p>–</p>

<p>我一看结果正确，非常兴奋，直接在上面代码加了个 -i ，直接更新原文的意思。</p>

<p>您猜怎么着？</p>

<p>它是直接用输出的结果去更新原文！就是说原文全部删除，保留的只是那些修改了的行！当然不是我要的结果。</p>

<p>还好我还有一份原文。重来。用文件重定向方便。但是我完全有信心不加那个 -n p 就没问题，所以再次编辑那个命令，输出-n p两个控制就好了。</p>

<h2>不犯错误对很多命令就无法真正的理解清楚啊！！</h2>

<p>哎。  ：） </p>

<p>之后我对文件又进行了多个修改用sed，再没出现类似错误。以后应该不会了</p>

    </body>
    <footer>
    <a href="../">Up    </a>
    <a href="/">Home</a>
    <!-- generated on 2013-01-23 09:56:03 +0800 -->
    </footer>
</html>

