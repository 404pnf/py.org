<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>drupal中批量删除垃圾留言的方法</title>
    <link href="/css/local.css" rel="stylesheet">
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3301463-1']);
    _gaq.push(['_trackPageview']);
   (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    </head>
    <body>
      <h1>drupal中批量删除垃圾留言的方法</h1>

<p>这种方法适用于留言是审核后才发表。垃圾留言和正常留言都在留言审核列表中。你可能每次只是选中不是垃圾的发表了，这样垃圾留言越来越多。如果超过上千条，每页每页删除非常麻烦。</p>

<p>直接说方法：</p>

<p>1 先把不是垃圾留言的都发表
2 用phpmyadmin浏览drupal数据库中comment的表寻找规律
3 我发现没有发表的status是1，发表了的是0 uid 是0 可能匿名用是0吧
4 根据status或者uid排列所有留言
5 调整每页显示数据条数来做到圈选删除。</p>

<p>比如我有一个站点半年多了，曾经受到垃圾留言供给严重。当时我用了审核后发表，所以审核队列有4000多条垃圾留言。在drupal中没有方便的方法删除。去drupal.org看了很多方法，学了一条sql语句。直接运行，那条语句也就是删除status是1的留言。但删除后我的站点也无法显示status是0的留言了。不知道怎么回事。</p>

<p>今天我观察出uid 0的这个规律。</p>

<p>于是，按uid升序，每页显示1000条，全璇，删除，后每页显示100条，全选删除。很快就删除了所有积压的垃圾留言。</p>

<p>很多朋友不能用phpmyadmin来管理，那么哪位高人给写个sql命令？</p>

    </body>
    <footer>
    <a href="../">Up    </a>
    <a href="/">Home</a>
    <!-- generated on 2013-01-23 09:56:06 +0800 -->
    </footer>
</html>

